<!-- jQuery first, then Bootstrap JS. -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

<nav class="navbar navbar-dark bg-dark fixed-top navbar-expand-md">
  <button class="navbar-toggler"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#collapsingNavbar"
    aria-controls="navbarSupportedContent"
    aria-expanded="false"
    aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse"
    id="collapsingNavbar">
    <ul class="nav navbar-nav me-auto">
      <!-- full size nav -->
      <li class="nav-item d-none d-sm-none d-md-block">
        <a class="nav-link"
          href="index#home">
          <img src="assets/Arkime_Logo_Mark_White@3x.png" />
        </a>
      </li>
      <li class="nav-item dropdown ms-4 d-none d-sm-none d-md-block">
        <a class="nav-link dropdown-toggle cursor-pointer main-home-link"
          data-bs-toggle="dropdown"
          role="button"
          aria-haspopup="true"
          aria-expanded="false">
          <strong>Arkime</strong>
        </a>
        <div class="dropdown-menu">
          <a class="dropdown-item home-link"
            onclick="setActive('home')"
            href="index#home">
            Home
          </a>
          <a class="dropdown-item demo-link"
            onclick="setActive('demo')"
            href="/demo">
            Demo
          </a>
          <a class="dropdown-item screenshots-link"
            onclick="setActive('screenshots')"
            href="index#screenshots">
            Screenshots
          </a>
          <a class="dropdown-item help-link"
            onclick="setActive('help')"
            href="index#help">
            Help
          </a>
        </div>
      </li>
      <li class="nav-item dropdown d-none d-sm-none d-md-block">
        <a class="nav-link dropdown-toggle cursor-pointer downloads-link"
          data-bs-toggle="dropdown"
          role="button"
          aria-haspopup="true"
          aria-expanded="false">
          Download
        </a>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="https://github.com/arkime/arkime/releases/latest">
            Stable
          </a>
          <a class="dropdown-item" href="https://github.com/arkime/arkime/releases/tag/last-commit">
            Latest Commit
          </a>
          <a class="dropdown-item" href="https://github.com/arkime/arkime/releases">
            All Downloads
          </a>
          <a class="dropdown-item" href="/docker">
            Docker
          </a>
        </div>
      </li>
      <li class="nav-item d-none d-sm-none d-md-block">
        <a class="nav-link estimators-link"
          href="estimators">
          Estimators
        </a>
      </li>
      <li class="nav-item dropdown d-none d-sm-none d-md-block">
        <a class="nav-link dropdown-toggle cursor-pointer wiki-link"
          data-bs-toggle="dropdown"
          role="button"
          aria-haspopup="true"
          aria-expanded="false">
          Learn
        </a>
        <div class="dropdown-menu">
          <a class="dropdown-item install-link"
            href="install">
            Installation
          </a>
          <a class="dropdown-item docker-link"
            href="docker">
            Docker
          </a>
          <a class="dropdown-item faq-link"
            href="faq">
            FAQ
          </a>
          <a class="dropdown-item settings-link"
            href="settings">
            Settings
          </a>
          <a class="dropdown-item api-link"
            href="allapis">
            API
          </a>
          <a class="dropdown-item learn-link"
            href="learn">
            Docs
          </a>
        </div>
      </li>
      <li class="nav-item dropdown d-none d-sm-none d-md-block">
        <a class="nav-link dropdown-toggle cursor-pointer galleries-link"
          data-bs-toggle="dropdown"
          role="button"
          aria-haspopup="true"
          aria-expanded="false">
          Galleries
        </a>
        <div class="dropdown-menu">
          <a class="dropdown-item wise-configs-link"
            href="wise-configs">
            WISE Configs
          </a>
          <a class="dropdown-item rules-link"
            href="rules">
            Arkime Rules
          </a>
        </div>
      </li> <!-- /full size nav -->
      <!-- collapsed nav -->
      <div class="d-sm-block d-md-none pt-2 pb-2">
        <li class="nav-item">
          <a class="nav-link home-link pt-1 pb-1"
            href="index#home">
            <strong>Arkime Home</strong>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link downloads-link pt-1 pb-1"
            href="downloads">
            Downloads
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link estimators-link pt-1 pb-1"
            href="estimators">
            Estimators
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link faq-link pt-1 pb-1"
            href="faq">
            FAQ
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link settings-link pt-1 pb-1"
            href="settings">
            Settings
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link api-link pt-1 pb-1"
            href="allapis">
            API
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link learn-link pt-1 pb-1"
            href="learn">
            Docs
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link wise-config-link pt-1 pb-1"
            href="wise-configs">
            WISE 3.x Configs
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link rules-link pt-1 pb-1"
            href="rules">
            Arkime Rules
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link pt-1 pb-1"
            href="https://www.linkedin.com/company/arkime">
            LinkedIn
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link pt-1 pb-1"
            href="https://slackinvite.arkime.com/">
            Slack Us
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link pt-1 pb-1"
            href="https://github.com/arkime/arkime">
            Arkime GitHub
          </a>
        </li>
      </div> <!-- collapsed nav -->
    </ul>
    <div class="d-none d-sm-none d-md-flex align-items-center">
      <div class="switch-container" style="display:none;">
        <div class="switch">
          <div class="switch-btn"></div>
        </div>
        <span class="switch-label"></span>
      </div>
      <a href="https://github.com/sponsors/awick"
        class="btn btn-sm btn-outline-warning ms-1"
        title="Sponsor Arkime"
        data-bs-toggle="tooltip"
        data-bs-placement="bottom">
        <span class="fa fa-heart-o fa-2x"></span>
        <span class="hide">Sponsor</span>
      </a>
      <a href="https://www.linkedin.com/company/arkime"
        class="btn btn-sm btn-outline-primary ms-1"
        title="Join the conversation on LinkedIn"
        data-bs-toggle="tooltip"
        data-bs-placement="bottom">
        <span class="fa fa-linkedin-square fa-2x"></span>
        <span class="hide">LinkedIn</span>
      </a>
      <a href="https://slackinvite.arkime.com/"
        class="btn btn-sm btn-outline-danger ms-1"
        title="Join the conversation on Slack"
        data-bs-toggle="tooltip"
        data-bs-placement="bottom">
        <span class="fa fa-slack fa-2x"></span>
        <span class="hide">Slack Channel</span>
      </a>
      <a href="https://github.com/arkime/arkime"
        title="View Arkime on GitHub"
        data-bs-toggle="tooltip"
        data-bs-placement="bottom"
        class="btn btn-sm btn-outline-info ms-1">
        <span class="fa fa-github fa-2x"></span>
        <span class="hide">Arkime GitHub</span>
      </a>
    </div>
  </div>
</nav>

<script>
  const homeSubPaths = {
    home: true, demo: true, screenshots: true, help: true
  };

  const wikiSubPaths = {
    learn: true, faq: true, settings: true, api: true, allapis: true
  }

  // on home section navlink click, set active class and remove others
  function setActive (page) {
    for (let sp in homeSubPaths) {
      $(`.${sp}-link`).removeClass('active');
    }

    $(`.${page}-link`).addClass('active');
  }

  function toggleTheme () {
    if (!document.body.classList.contains('dark-theme')) {
      document.body.classList.add('dark-theme');
      $('.switch-label').text('dark mode');
      localStorage.setItem('theme', 'dark');
    } else {
      document.body.classList.remove('dark-theme');
      $('.switch-label').text('light mode');
      localStorage.setItem('theme', 'light');
    }
  }

  // content loaded
  $(function () {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.map(function (el) { return new bootstrap.Tooltip(el); });

    // set the active nav item
    let path = window.location.pathname.split('/')[1];
    let parentPath;

    if (!path || path === 'index') {
      parentPath = 'main-home';
      let hash = window.location.hash;

      if (hash) {
        path = hash.split('#')[1];
      }
    } else if (wikiSubPaths[path]) {
      parentPath = 'wiki';
    }

    $(`.${path}-link`).addClass('active');
    $(`.${parentPath}-link`).addClass('active');

    const themeSwitch = $('.switch-container');

    let darkMode;

    if (localStorage.getItem('theme')) {
      const savedTheme = localStorage.getItem('theme');
      darkMode = savedTheme === 'dark';
    } else {
      if (window.matchMedia) {
        darkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
      }
    }

    if (darkMode) {
      document.body.classList.add('dark-theme');
      $('.switch-label').text('dark mode');
    } else {
      $('.switch-label').text('light mode');
    }

    themeSwitch[0].style.display = 'inline-block';
    themeSwitch.click(toggleTheme);
  });
</script>
